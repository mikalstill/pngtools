repos:
  - repo: local
    hooks:
      # Note: actionlint and shellcheck run in separate pre-commit
      # environments (golang vs python), so actionlint cannot use
      # shellcheck to lint inline 'run:' scripts in workflows here.
      # CI catches those issues because both are system-installed.
      - id: actionlint
        name: actionlint
        entry: actionlint
        language: golang
        additional_dependencies:
          - github.com/rhysd/actionlint/cmd/actionlint@v1.7.10
        files: ^\.github/workflows/
        types: [yaml]

      - id: shellcheck
        name: shellcheck
        entry: shellcheck
        language: python
        additional_dependencies:
          - shellcheck-py==0.10.0.1
        files: ^scripts/

      - id: clang-format
        name: clang-format
        entry: scripts/check-format.sh
        language: system
        always_run: true
        pass_filenames: false

      - id: cppcheck
        name: cppcheck
        entry: cppcheck --error-exitcode=1 --enable=warning,style --suppress=missingIncludeSystem --suppress=normalCheckLevelMaxBranches
        language: system
        types: [c]

      - id: build-and-test
        name: build and test
        entry: scripts/build-and-test.sh
        language: system
        always_run: true
        pass_filenames: false
